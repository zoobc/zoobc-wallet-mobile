<ion-header no-border>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button>
      </ion-back-button>
    </ion-buttons>
    <ion-title>{{ "Send" | translate }} ZBC</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Custom Refresher Content -->
  <ion-refresher slot="fixed" style="background: #ffffff;" (ionRefresh)="doRefresh($event)">
      <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="Pull to refresh" refreshingSpinner="circles"
        refreshingText="{{ 'Refreshing' | translate }} ...">
      </ion-refresher-content>
  </ion-refresher>
  
  <div *ngIf="isLoadingBalance || isLoadingTxFee">
    <ion-progress-bar type="indeterminate"></ion-progress-bar>
  </div>
  <ion-card>
    <ion-card-header>
      <ion-card-subtitle>{{ "From Account" | translate }}<ion-text color="danger">*</ion-text>
      </ion-card-subtitle>
    </ion-card-header>

    <ion-item *ngIf="account" (click)="openListAccount('sender')">
      <ion-label>
        <h3>{{"Name" | translate}}: {{ account.accountName }}</h3>
        <p>{{"Address" | translate}}: {{ account.address }}</p>
        <p>Balance: <span>{{ account.balance }} ZBC</span></p>
      </ion-label>
      <ion-icon name="arrow-dropdown" slot="end"></ion-icon>
    </ion-item>

  </ion-card>

  <ion-card>
    <ion-item>
      <ion-icon name="bookmarks" (click)="openAddresses()" slot="end"></ion-icon>
      <ion-icon name="qr-scanner" (click)="scanQrCode()" slot="end"></ion-icon>
      <ion-icon name="albums" slot="end" (click)="openListAccount('recipient')"></ion-icon>
    </ion-item>


    <ion-item>
      <ion-label position="stacked">
        {{ "Pay to" | translate }} <ion-text color="danger">*</ion-text>
      </ion-label>
      <ion-textarea rows="3" debounce=1 maxlength=60 wrap='hard' required
        placeholder="{{'Enter recipient address'|translate}} ..." name="recipient" type="text" style="font-weight: bold"
        (ionChange)="validateRecipient()" [(ngModel)]="recipient" ngModel required>
      </ion-textarea>

    </ion-item>

    <ion-item lines="none" *ngIf="!isRecipientValid">
      <ion-label color="danger">Recipient {{ "Address is not valid" | translate }}!</ion-label>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">{{ "Amount" | translate }} <ion-text color="danger">*</ion-text>
      </ion-label>
      <ion-input value='0.01' style="font-weight: bold" placeholder="{{'Enter amount'|translate}} ..."
        (ionChange)="validateAmount()" required name="amount" maxlength="12" type="number" [(ngModel)]="amount"
        required></ion-input>
    </ion-item>

    <ion-item lines="none" *ngIf="!isAmountValid">
      <ion-label color="danger" class="displayerror">{{ amountMsg }}!</ion-label>
    </ion-item>

  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-label position="stacked" class="stacked">
        {{ "Transaction Fee" | translate }} <ion-text color="danger">*</ion-text>
      </ion-label>
    </ion-card-header>
    <div id="container">
      <ion-button class="twolines fee-button" *ngFor="let trxFee of allFees" (click)="changeFee(trxFee);">
        <p>{{ trxFee.name }} <br />
          {{ trxFee.fee | number: '0.0-4' }} ZBC<br />
          {{ trxFee.fee * currencyRate.value | number: '0.0-2' }}
          {{ currencyRate.name }}
        </p>
      </ion-button>
    </div>

    <ion-item lines="none">
      <ion-checkbox slot="start" [(ngModel)]="customeChecked" (ionChange)="customfeeChecked()"></ion-checkbox>
      <ion-label>{{ "Custom Fee" | translate }}</ion-label>
    </ion-item>
    <ion-item lines="none">
      <ion-input *ngIf="customeChecked" placeholder="{{'Enter amount'|translate}} ..." (ionChange)="validateCustomFee()"
        required name="customfee" maxlength="12" type="number" [(ngModel)]="customfee" required></ion-input>
    </ion-item>
    <ion-item *ngIf="!isFeeValid">
      <ion-label color="danger">{{ "Select one transaction fee" | translate }} or input custom fee!
      </ion-label>
    </ion-item>
  </ion-card>

  <ion-item lines="none"  (click)="showAdvance()">
    <ion-label *ngIf="!isAdvance">
        <b><ion-icon name="arrow-dropdown"></ion-icon> Show Advance (coming soon)</b> 
    </ion-label>
    

    <ion-label *ngIf="isAdvance">
        <b><ion-icon name="arrow-dropup"></ion-icon> Hide Advance  (coming soon)</b> 
    </ion-label>

  </ion-item>

  <ion-card *ngIf="isAdvance">

    <ion-item>
      <ion-label position="stacked">{{ "Approver Address" | translate }} </ion-label>
      <ion-input value='' style="font-weight: bold" placeholder="Enter approver ..."
         name="approver" maxlength="12" type="text"></ion-input>
    </ion-item>
    
    <ion-item>
      <ion-label position="stacked">{{ "Approver Commision" | translate }} </ion-label>
      <ion-input value='0.0' style="font-weight: bold" placeholder="Enter approver commision ..."
         name="approverCommision" maxlength="12" type="number"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">{{ "Timeout" | translate }}</ion-label>
      <ion-input value='' style="font-weight: bold" placeholder="Enter timeout ..."
         name="timout" maxlength="12" type="number"></ion-input>
    </ion-item>

  </ion-card>

  <div style="text-align:center" style="padding:20px;">
    <ion-button color="secondary" *ngIf="!isLoadingBalance && !isLoadingTxFee" (click)="showConfirmation()" style="width: 100%"
      expand="block">
      {{ "Next" | translate }}
    </ion-button>
    <ion-button disabled color="secondary" *ngIf="isLoadingBalance || isLoadingTxFee" (click)="showConfirmation()" style="width: 100%"
      expand="block">
      {{ "Next" | translate }}
    </ion-button>
  </div>

</ion-content>


<!-- <ion-content>
  <div *ngIf="isLoadingBalance">
    <ion-progress-bar type="indeterminate"></ion-progress-bar>
  </div>
  <div *ngIf="errorMsg">
    <ion-label  style="color: red">{{ errorMsg }}</ion-label>
  </div>

  <form #form="ngForm" (ngSubmit)="submit()">
    <ion-grid>

      <ion-row>
        <ion-col>

          <ion-item lines="none" style="margin-bottom: 0px;">
            <ion-label position="stacked" class="stacked">
              {{ "From account" | translate }} </ion-label>
            <ion-select class="select-zbc" [(ngModel)]="account" (ngModelChange)="switchAccount(account)" *ngIf="!isLoadingBalance" placeholder="-- Select Account --"
              interface="popover" name="account" >
              <ion-select-option class="select-zbc" *ngFor="let acc of allAccounts" [value]="acc">
                {{ acc.name }} | {{acc.balance | number: '0.0-6'}} ZBC
              </ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label *ngIf="!isLoadingBalance">
              <span style="font-size: 0.9rem; font-weight: bold">
              {{"Address" | translate}}:  {{ account.shortAddress }}
              </span>
            </ion-label>
          </ion-item>

          <ion-item-divider lines="none" style="border: 0px;">
            <ion-buttons slot="end">
              <button (click)="scanQrCode()" style="margin-right: 10px;">
                <ion-icon name="qr-scanner"></ion-icon>
              </button>
              <button (click)="openAddresses()" style="margin-right: 10px;">
                <ion-icon name="bookmarks"></ion-icon>
              </button>
            </ion-buttons>
          </ion-item-divider>

          <ion-item>
            <ion-label position="stacked" class="stacked">
              {{ "Pay to" | translate }} <ion-text color="danger">*</ion-text>
            </ion-label>
            <ion-textarea rows="3" debounce=1 maxlength=60 wrap='hard' required placeholder="{{'Enter recipient address'|translate}} ..." 
              name="recipient" type="text" style="font-weight: bold" (ionChange)="validateRecipient()" [(ngModel)]="recipient" ngModel required>
             
            </ion-textarea>
          </ion-item>
          <ion-item lines="none" *ngIf="!isRecipientValid">
            <ion-label class="displayerror">{{ "Address is not valid" | translate }}!</ion-label>
          </ion-item>
        </ion-col>
      </ion-row>

      <ion-row>
        <ion-col>
          <ion-item >
            <ion-label position="stacked" class="stacked">
              {{ "Amount" | translate }} <ion-text color="danger">*</ion-text>
            </ion-label>
            <ion-input value='0.01' style="font-weight: bold" placeholder="{{'Enter amount'|translate}} ..." (ionChange)="validateAmount()" required name="amount" maxlength="12" type="number" [(ngModel)]="amount"
              required></ion-input>
          </ion-item>
          <ion-item lines="none" *ngIf="!isAmountValid">
            <ion-label color="danger" class="displayerror">{{ amountMsg }}!</ion-label>
          </ion-item>
        </ion-col>
      </ion-row>

      <ion-row>
        <ion-col>
          <ion-item lines="none">
            <ion-label position="stacked" class="stacked">
              {{ "Transaction Fee" | translate }} <ion-text color="danger">*</ion-text></ion-label>
            <ion-select interface="popover" name="fee" [(ngModel)]="fee" (ngModelChange)="changeFee(fee)">
              <ion-select-option *ngFor="let trxFee of allFees" [value]="trxFee">
                  {{ trxFee.name }} | {{trxFee.fee }} ZBC
              </ion-select-option>
            </ion-select>
          </ion-item>
          <ion-item>
            <ion-label position="stacked">Custom Fee</ion-label>
            <ion-toggle slot="start" [(ngModel)]="customeChecked" (ionChange)="customfeeChecked()" color="light" name="customeChecked"></ion-toggle>
            <ion-input *ngIf="customeChecked" placeholder="{{'Enter amount'|translate}} ..." (ionChange)="validateCustomFee()" required name="customfee" maxlength="12" type="number" [(ngModel)]="customfee"
            required></ion-input>
          </ion-item>
          <ion-item  *ngIf="!isFeeValid">
            <ion-label  class="displayerror">{{ "Select one transaction fee" | translate }}!
            </ion-label> 
          </ion-item>
          <ion-item-divider style="border:none" lines="none">

          </ion-item-divider>
        </ion-col>
      </ion-row>

      <ion-row>
        <ion-col>
          <ion-button color="secondary" *ngIf="!isLoadingBalance" (click)="showConfirmation()" expand="block">
            {{ "Next" | translate }}
          </ion-button>
          <ion-button disabled color="secondary" *ngIf="isLoadingBalance" (click)="showConfirmation()" expand="block">
            {{ "Next" | translate }}
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>

</ion-content> -->